#!/usr/bin/env vtkpython
# -*- python -*-
#
from PyQt4.QtGui import *
from PyQt4.QtCore import *
import sys, os, re
import icons
from optparse import OptionParser

def main():
    app = QApplication(sys.argv)

    parser = OptionParser()
    parser.add_option("-l", "--level", help="Global approximation level", 
                      type="int", dest="level", default=4)
    parser.add_option("-p", "--passes", help="EZW pass limit", 
                      type="int", dest="passes", default=0)
    (options, args) = parser.parse_args()

    # Initialize icons.
    mydir = re.sub("/[^/]*$", "", os.path.abspath(__file__))
    icons.addSearchPath(mydir + "/icons")
    icons.addSearchPath(mydir + "/../share/libra/icons")

    icon = icons.get("libra_logo256")
    pixmap = icon.pixmap(icon.actualSize(QSize(512,512)))
    splash = QSplashScreen(pixmap)
    splash.show()

    from viewer import Viewer
    viewer = Viewer(options.level, options.passes)
    viewer.show()
    splash.finish(viewer)

    def finalize():
        app.quit()

    app.connect(app, SIGNAL( 'lastWindowClosed()' ), finalize);

    sys.exit(app.exec_())


if __name__ == "__main__":
    main()
